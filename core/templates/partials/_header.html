{% load static %}
<header class="header">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Global Bar - Hidden on mobile -->
    <div class="global-bar">
        <div class="container">
    {% comment %} Links visible to unauthenticated users (Public) {% endcomment %}
    {% if not user.is_authenticated %}
    <div class="global-links">
        <a href="{% url 'public_chatbot_view' %}"
           style="text-decoration: none; color: #1e88e5; font-weight: 600; font-size: 1.1rem; padding: 5px 10px; border-radius: 5px; transition: color 0.3s ease;"
           onmouseover="this.style.color='#0a5eb5'" onmouseout="this.style.color='#1e88e5'">
            ðŸ¤– Ask OB
        </a>
        <a href="{% url 'rfp_guide' %}" class="global-link"><i class="fas fa-question-circle"></i> <span>RFP Guide</span></a>
<span class="separator">|</span>
        <a href="{% url 'contact' %}" class="global-link"><i class="fas fa-envelope"></i> <span>Contact Us</span></a>
        <span class="separator">|</span>
        <a href="{% url 'newsletter:subscribe' %}" class="global-link"><i class="fas fa-bell"></i> <span>Subscription</span></a>
        <span class="separator">|</span>
        <a href="{% url 'client_portal' %}" id="portalLink" class="global-link admin-link"><i class="fas fa-lock"></i> <span>Portal</span></a>
    </div>

    {% comment %} Links visible to authenticated users (Private) {% endcomment %}
    {% else %}
    <div class="global-links">
<a href="{% url 'chatbot_view' %}" class="global-link chatbot-link">
            <i class="fas fa-robot"></i> <span>AI Chatbot</span>
        </a>
        {% comment %}
        RFP Link Visibility Logic:
        Check if the user is authenticated AND their role is 'admin' OR 'client'.
        Note: You should replace 'rfp_list' with 'rfp_create' if you want them to go straight to the submission form.
        I used 'rfp_list' as it's the main entry point to view existing proposals.
        {% endcomment %}
        {% if user.role == 'admin' or user.role == 'client' %}
        <a href="{% url 'rfp_list' %}"
           style="text-decoration: none; color: #1e88e5; font-weight: 600; font-size: 1.1rem; padding: 5px 10px; border-radius: 5px; transition: color 0.3s ease;"
           onmouseover="this.style.color='#0a5eb5'"
           onmouseout="this.style.color='#1e88e5'">
            ðŸ“„ RFP Management
        </a>
        <span class="separator">|</span>
        {% endif %}
{% if request.user.role == 'admin' or request.user.role == 'staff' %}
    
    <!-- Add Fieldwork link for both admin and staff -->
    {% if request.user.role == 'admin' %}
        <a href="{% url 'fieldwork:field_job_list' %}" class="global-link"><i class="global-link chatbot-link"></i> <span>Fieldwork</span></a>
    {% else %}
        <a href="{% url 'fieldwork:staff_field_jobs' %}" class="global-link"><i class="global-link chatbot-link"></i> <span>Fieldwork</span></a>
    {% endif %}
    <span class="separator">|</span>
{% endif %}
        {% comment %} Links available to all authenticated users {% endcomment %}

        <span class="separator">|</span>
        <a href="{% url 'user_logout' %}" class="global-link"><i class="fas fa-sign-out-alt"></i> <span>Logout</span></a>
    </div>
    {% endif %}
</div>
    </div>

    <!-- Main Header -->
    <div class="header-container">
        <div class="logo-container">
            <a href="{% if user.is_authenticated %}{% url 'dashboard' %}{% else %}{% url 'index' %}{% endif %}" class="logo">
                <img src="{% static 'images/logo.png' %}" alt="OB Global Logo" class="logo-image">
                <span class="global-text">GLOBAL</span>
            </a>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>

        <!-- Desktop Navigation -->
        {% if not user.is_authenticated %}
        <nav class="nav-menu">
    <ul class="nav-list">
        <!-- Forensic Service -->
        <li class="nav-item">
            <a href="#" class="nav-link">Forensic Service</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Core Services</h4>
                            <a href="#" class="dropdown-link">Data Analytics</a>
                            <a href="#" class="dropdown-link">IT Governance</a>
                            <a href="#" class="dropdown-link">Fraud Assessment and Analysis</a>
                            <a href="#" class="dropdown-link">Forensic Accounting</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Investigation</h4>
                            <a href="#" class="dropdown-link">Fraud Inquiry</a>
                            <a href="#" class="dropdown-link">Litigation Support</a>
                            <a href="#" class="dropdown-link">Bank and Financial Statement Analysis</a>
                            <a href="#" class="dropdown-link">Internal Investigation</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Analysis & Reporting</h4>
                            <a href="#" class="dropdown-link">Data Benchmarking</a>
                            <a href="#" class="dropdown-link">Creating Effective Financial Exhibits</a>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Computer Forensic</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Bankruptcy</a></li>
                                </ul>
                            </div>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Inventory and Valuation Analysis</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Asset Misappropriation</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Corporate Valuation Dispute</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Audit -->
        <li class="nav-item">
            <a href="#" class="nav-link">Audit</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Audit Services</h4>
                            <a href="#" class="dropdown-link">Compilation and Audit Review</a>
                            <a href="#" class="dropdown-link">Operational Audit</a>
                            <a href="#" class="dropdown-link">Agreed Upon Procedure</a>
                            <a href="#" class="dropdown-link">Follow-up Audit</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Specialized Audits</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Financial Audit</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Internal Audit</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Performance Audit</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Compliance Audit</a></li>
                                </ul>
                            </div>
                            <a href="#" class="dropdown-link">Forensic Audit</a>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Tax -->
        <li class="nav-item">
            <a href="#" class="nav-link">Tax</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Tax Services</h4>
                            <a href="#" class="dropdown-link">Tax Preparation & Filing</a>
                            <a href="#" class="dropdown-link">Tax Compliance</a>
                            <a href="#" class="dropdown-link">Payroll Tax</a>
                            <a href="#" class="dropdown-link">Business & Personal Tax</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Tax Education</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Tax Education</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Tax Accounting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Tax Advisory</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Consulting -->
        <li class="nav-item">
            <a href="#" class="nav-link">Consulting</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Business Consulting</h4>
                            <a href="#" class="dropdown-link">Tax Consulting and Planning</a>
                            <a href="#" class="dropdown-link">Tax Policy and Implementation</a>
                            <a href="#" class="dropdown-link">Grant Management</a>
                            <a href="#" class="dropdown-link">Business Analysis</a>
                            <a href="#" class="dropdown-link">Risk Assessment</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Operational Consulting</h4>
                            <a href="#" class="dropdown-link">Internal Control Review and Analysis</a>
                            <a href="#" class="dropdown-link">Micro-assessment</a>
                            <a href="#" class="dropdown-link">Spot Check</a>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Forensic Audit and Investigation</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Reviews and Compilations of Financial Statements</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Specialized Consulting</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Fraud Assessment and Analysis</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Management Consulting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Financial Advisory Consulting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Risk & Compliance Consulting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Operational Consulting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Fraud Advisory</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Advisory -->
        <li class="nav-item">
            <a href="#" class="nav-link">Advisory</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Forensic Services</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Forensic Accounting</a>
                                <ul class="sub-dropdown">
                                    <li class="sub-sub-menu">
                                        <a href="#" class="sub-dropdown-link">Financial Accounting â€“ Outsourcing</a>
                                        <ul class="sub-sub-dropdown">
                                            <li><a href="#" class="sub-sub-dropdown-link">CFO Service</a></li>
                                            <li><a href="#" class="sub-sub-dropdown-link">Book-keeping Service</a></li>
                                            <li><a href="#" class="sub-sub-dropdown-link">Tax Planning and Advisory</a></li>
                                            <li><a href="#" class="sub-sub-dropdown-link">Internal Control (SOX) Compliance</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Forensic Audit and Investigation Analysis</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Payroll Processing and Management</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Account Management and Bookkeeping</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Advisory Services</h4>
                            <a href="#" class="dropdown-link">Tax Planning and Advisory</a>
                            <a href="#" class="dropdown-link">Financial Accounting Advisory</a>
                            <a href="#" class="dropdown-link">Internal Control Compliance (SOX)</a>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Technology Solutions -->
        <li class="nav-item">
            <a href="#" class="nav-link">Technology Solutions</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Implementation Services</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">IT Project Management Service</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Hardware Implementation Management</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Software Implementation Management</a></li>
                                </ul>
                            </div>
                            <a href="#" class="dropdown-link">Software Deployment and Management</a>
                            <a href="#" class="dropdown-link">Hardware Deployment and Maintenance</a>
                            <a href="#" class="dropdown-link">IT Project Management</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Security & Consulting</h4>
                            <a href="#" class="dropdown-link">Cybersecurity Assessment and Management</a>
                            <a href="#" class="dropdown-link">Technology Consulting</a>
                            <a href="#" class="dropdown-link">IT Consulting</a>
                            <a href="#" class="dropdown-link">Managed IT Service</a>
                            <a href="#" class="dropdown-link">IT Security</a>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Asset & Support</h4>
                            <a href="#" class="dropdown-link">Cybersecurity</a>
                            <a href="#" class="dropdown-link">Service Desk/Help Desk</a>
                            <a href="#" class="dropdown-link">Equipment Supply and Setup</a>
                            <a href="#" class="dropdown-link">Inventory Count and Assets Management</a>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Inventory and Asset Management</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Asset Registry</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Barcoding</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </ul>
        </li>

        <!-- Managed Service -->
        <li class="nav-item">
            <a href="#" class="nav-link">Managed Service</a>
            <ul class="dropdown">
                <div class="dropdown-grid">
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Accounting Services</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Accounting Services</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Account Management/Bookkeeping</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Financial Statement Preparation</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Bank Reconciliation</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Account Payable/Receivable</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Budget and Forecasting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Forensic Accounting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Business Consulting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Public Accounting</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Tax Services</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Tax Services</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Tax Planning</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Payroll Tax</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Individual Tax - 1040</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Business Tax â€“ 1120s and 1120</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Non-for-profit Tax â€“ 990</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Tax Accounting</a></li>
                                    <li><a href="#" class="sub-dropdown-link">International Tax</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="dropdown-column">
                        <div class="dropdown-section">
                            <h4 class="dropdown-section-title">Technology Services</h4>
                            <div class="sub-menu">
                                <a href="#" class="dropdown-link">Technology Services</a>
                                <ul class="sub-dropdown">
                                    <li><a href="#" class="sub-dropdown-link">Asset Tracking and Management</a></li>
                                    <li><a href="#" class="sub-dropdown-link">IT Support Management</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Cybersecurity</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Network Support/Health Check</a></li>
                                    <li><a href="#" class="sub-dropdown-link">Inventory</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </ul>
        </li>
    </ul>
</nav>
        {% endif %}

       <!-- User Links - Hidden on mobile, visible on desktop -->
<div class="global-links desktop-only">
    {% if user.role == 'admin' %}
         <a href="{% url 'attendance:admin_dashboard' %}" class="global-link admin-link"><i class="fas fa-clipboard-check"></i> <span>Attendance Management</span></a>
<a href="{% url 'attendance:admin_leave_requests' %}" class="global-link admin-link"><i class="fas fa-clipboard-list"></i> <span>Leave Management</span></a>

    <a href="{% url 'manage_offices' %}" class="global-link admin-link"><i class="fas fa-building"></i> <span>Manage Offices</span></a>
        <span class="separator">|</span>
        <a href="{% url 'manage_users' %}" class="global-link admin-link"><i class="fas fa-users-cog"></i> <span>Manage Users</span></a>
    <span class="separator">|</span>
    <a href="{% url 'newsletter:admin_dashboard' %}" class="global-link admin-link"><i class="fas fa-paper-plane"></i> <span>Newsletter</span></a>
    <span class="separator">|</span>
    {% endif %}

    {% if request.user.is_authenticated %}
        <!-- User links -->
                
                    {% if user.role == 'staff'%}
<!-- Staff Links -->
<a href="{% url 'attendance:dashboard' %}" class="global-link"><i class="fas fa-user-clock"></i> <span>Attendance</span></a>

<a href="{% url 'attendance:my_leave_requests' %}" class="global-link"><i class="far fa-calendar-alt"></i> <span>My Leave</span></a>

{% endif %}
        
        {% if request.user.role == 'admin' or request.user.role == 'staff' %}
            <a href="{% url 'task_list' %}" class="global-link"><i class="fas fa-tasks"></i> <span>Tasks</span></a>
            <span class="separator">|</span>
           {% endif %}
        <a href="{% url 'view_my_profile' %}" class="global-link profile-link">
            <div class="face-card-container">
                {% if request.user.profile_image %}
                    <img src="{{ request.user.profile_image }}" alt="Profile Image" class="face-card-image">
                {% else %}
                    <div class="face-card-initials">{{ request.user.first_name|first }}{{ request.user.last_name|first }}</div>
                {% endif %}
            </div>
            <div class="face-card-info">
                <span class="face-card-name">{{ request.user.get_full_name }}</span>
                <span class="face-card-role">{{ request.user.get_role_display }}</span>
            </div>
        </a>
    {% endif %}
</div>

    <!-- Mobile Sidebar Menu -->
    <div class="mobile-sidebar">
        <div class="mobile-sidebar-header">
            <div class="mobile-logo">
                <img src="{% static 'images/logo.png' %}" alt="OB Global Logo" class="logo-image">
                <span class="global-text">GLOBAL</span>
            </div>
            <button class="mobile-close-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="mobile-menu-content">
            <!-- Mobile Global Links -->
            <div class="mobile-global-links">
                <!-- Global links from top bar -->
                {% if not user.is_authenticated %}
                    <a href="{% url 'public_chatbot_view' %}"
   style="text-decoration: none; color: #1e88e5; font-weight: 600; font-size: 1.1rem; padding: 5px 10px; border-radius: 5px; transition: color 0.3s ease;"
   onmouseover="this.style.color='#0a5eb5'"
   onmouseout="this.style.color='#1e88e5'">
    ðŸ¤– Ask OB
</a>
                <a href="{% url 'contact' %}" class="mobile-global-link"><i class="fas fa-envelope"></i> Contact Us</a>
                <a href="{% url 'rfp_guide' %}" class="global-link"><i class="fas fa-question-circle"></i> <span>RFP Guide</span></a>
<span class="separator">|</span>
                <a href="{% url 'newsletter:subscribe' %}" class="mobile-global-link"><i class="fas fa-bell"></i> Subscription</a>
                <a href="{% url 'client_portal' %}" class="mobile-global-link admin-link"><i class="fas fa-lock"></i> Portal</a>
                {% else %}
                <a href="{% url 'user_logout' %}" class="mobile-global-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
                {% endif %}

                <!-- Admin links -->
                {% if user.role == 'admin' %}
                    <a href="{% url 'attendance:admin_dashboard' %}" class="mobile-global-link admin-link"><i class="fas fa-clipboard-check"></i> <span>Attendance Management</span></a>

<a href="{% url 'attendance:admin_leave_requests' %}" class="mobile-global-link admin-link"><i class="fas fa-clipboard-list"></i> <span>Leave Management</span></a>


                    <a href="{% url 'manage_users' %}" class="mobile-global-link admin-link"><i class="fas fa-users-cog"></i> Manage Users</a>
                <a href="{% url 'newsletter:admin_dashboard' %}" class="mobile-global-link admin-link"><i class="fas fa-paper-plane"></i> Newsletter</a>
                    <a href="{% url 'manage_offices' %}" class="mobile-global-link admin-link"><i class="fas fa-building"></i> <span>Manage Offices</span></a>

                {% endif %}

                <!-- User links -->
                {% if request.user.is_authenticated %}
                    {% if user.role == 'staff'%}
<!-- Staff Links -->
<a href="{% url 'attendance:dashboard' %}" class="mobile-global-link admin-link"><i class="fas fa-user-clock"></i> <span>Attendance</span></a>

<a href="{% url 'attendance:my_leave_requests' %}" class="mobile-global-link admin-link"><i class="far fa-calendar-alt"></i> <span>My Leave</span></a>

{% endif %}
                    {% if user.role == 'admin' or user.role == 'client' %}
        <a href="{% url 'rfp_list' %}" class="mobile-global-link admin-link">
            ðŸ“„ RFP Management
        </a>

        {% endif %}
                <a href="{% url 'chatbot_view' %}" class="mobile-global-link admin-link">
                    <i class="fas fa-robot"></i> AI Chatbot
                </a>
                {% if request.user.role == 'admin' or request.user.role == 'staff' %}
                <a href="{% url 'task_list' %}" class="mobile-global-link admin-link"><i class="fas fa-tasks"></i> Tasks</a>
                {% if request.user.role == 'admin' %}
        <a href="{% url 'fieldwork:field_job_list' %}" class="mobile-global-link admin-link"><i class="fas fa-clipboard-list"></i> <span>Fieldwork</span></a>
    {% else %}
        <a href="{% url 'fieldwork:staff_field_jobs' %}" class="mobile-global-link admin-link"><i class="fas fa-clipboard-list"></i> <span>Fieldwork</span></a>
    {% endif %}
                {% endif %}

                <!-- Profile link -->
                <a href="{% url 'view_my_profile' %}" class="global-link profile-link">
                    <div class="face-card-container">
                        {% if request.user.profile_image %}
                            <img src="{{ request.user.profile_image }}" alt="Profile Image" class="face-card-image">

                        {% else %}
                            <div class="face-card-initials">{{ request.user.first_name|first }}{{ request.user.last_name|first }}</div>
                        {% endif %}
                    </div>
                    <div class="face-card-info">
                        <span class="face-card-name">{{ request.user.get_full_name }}</span>
                        <span class="face-card-role">{{ request.user.get_role_display }}</span>
                    </div>
                </a>
                {% endif %}
            </div>

            <!-- Mobile Navigation Menu -->
{% if not user.is_authenticated %}
<nav class="mobile-nav-menu">
    <ul class="mobile-nav-list">
        <!-- Forensic Service -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Forensic Service <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li><a href="#" class="mobile-dropdown-link">Data Analytics</a></li>
                <li><a href="#" class="mobile-dropdown-link">IT Governance</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Computer Forensic <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Bankruptcy</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Fraud Assessment and Analysis</a></li>
                <li><a href="#" class="mobile-dropdown-link">Forensic Accounting</a></li>
                <li><a href="#" class="mobile-dropdown-link">Fraud Inquiry</a></li>
                <li><a href="#" class="mobile-dropdown-link">Litigation Support</a></li>
                <li><a href="#" class="mobile-dropdown-link">Bank and Financial Statement Analysis</a></li>
                <li><a href="#" class="mobile-dropdown-link">Internal Investigation</a></li>
                <li><a href="#" class="mobile-dropdown-link">Data Benchmarking</a></li>
                <li><a href="#" class="mobile-dropdown-link">Creating Effective Financial Exhibits</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Inventory and Valuation Analysis <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Asset Misappropriation</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Corporate Valuation Dispute</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <!-- Audit -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Audit <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li><a href="#" class="mobile-dropdown-link">Compilation and Audit Review</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Financial Audit <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Internal Audit</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Performance Audit</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Compliance Audit</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Operational Audit</a></li>
                <li><a href="#" class="mobile-dropdown-link">Agreed Upon Procedure</a></li>
                <li><a href="#" class="mobile-dropdown-link">Follow-up Audit</a></li>
                <li><a href="#" class="mobile-dropdown-link">Forensic Audit</a></li>
            </ul>
        </li>

        <!-- Tax -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Tax <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li><a href="#" class="mobile-dropdown-link">Tax Preparation & Filing</a></li>
                <li><a href="#" class="mobile-dropdown-link">Tax Compliance</a></li>
                <li><a href="#" class="mobile-dropdown-link">Payroll Tax</a></li>
                <li><a href="#" class="mobile-dropdown-link">Business & Personal Tax</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Tax Education <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Tax Accounting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Tax Advisory</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <!-- Consulting -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Consulting <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li><a href="#" class="mobile-dropdown-link">Tax Consulting and Planning</a></li>
                <li><a href="#" class="mobile-dropdown-link">Tax Policy and Implementation</a></li>
                <li><a href="#" class="mobile-dropdown-link">Grant Management</a></li>
                <li><a href="#" class="mobile-dropdown-link">Business Analysis</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Forensic Audit and Investigation <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Reviews and Compilations of Financial Statements</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Risk Assessment</a></li>
                <li><a href="#" class="mobile-dropdown-link">Internal Control Review and Analysis</a></li>
                <li><a href="#" class="mobile-dropdown-link">Micro-assessment</a></li>
                <li><a href="#" class="mobile-dropdown-link">Spot Check</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Fraud Assessment and Analysis <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Management Consulting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Financial Advisory Consulting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Risk & Compliance Consulting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Operational Consulting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Fraud Advisory</a></li>
                    </ul>
                </li>
            </ul>
        </li>

        <!-- Advisory -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Advisory <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Forensic Accounting <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li class="mobile-sub-sub-menu">
                            <a href="#" class="mobile-sub-dropdown-link">Financial Accounting â€“ Outsourcing <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                            <ul class="mobile-sub-sub-dropdown">
                                <li><a href="#" class="mobile-sub-sub-dropdown-link">CFO Service</a></li>
                                <li><a href="#" class="mobile-sub-sub-dropdown-link">Book-keeping Service</a></li>
                                <li><a href="#" class="mobile-sub-sub-dropdown-link">Tax Planning and Advisory</a></li>
                                <li><a href="#" class="mobile-sub-sub-dropdown-link">Internal Control (SOX) Compliance</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Forensic Audit and Investigation Analysis <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Payroll Processing and Management</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Account Management and Bookkeeping</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Tax Planning and Advisory</a></li>
                <li><a href="#" class="mobile-dropdown-link">Financial Accounting Advisory</a></li>
                <li><a href="#" class="mobile-dropdown-link">Internal Control Compliance (SOX)</a></li>
            </ul>
        </li>

        <!-- Technology Solutions -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Technology Solutions <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">IT Project Management Service <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Hardware Implementation Management</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Software Implementation Management</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Software Deployment and Management</a></li>
                <li><a href="#" class="mobile-dropdown-link">Hardware Deployment and Maintenance</a></li>
                <li><a href="#" class="mobile-dropdown-link">Cybersecurity Assessment and Management</a></li>
                <li><a href="#" class="mobile-dropdown-link">IT Project Management</a></li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Inventory and Asset Management <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Asset Registry</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Barcoding</a></li>
                    </ul>
                </li>
                <li><a href="#" class="mobile-dropdown-link">Technology Consulting</a></li>
                <li><a href="#" class="mobile-dropdown-link">IT Consulting</a></li>
                <li><a href="#" class="mobile-dropdown-link">Managed IT Service</a></li>
                <li><a href="#" class="mobile-dropdown-link">IT Security</a></li>
                <li><a href="#" class="mobile-dropdown-link">Cybersecurity</a></li>
                <li><a href="#" class="mobile-dropdown-link">Service Desk/Help Desk</a></li>
                <li><a href="#" class="mobile-dropdown-link">Equipment Supply and Setup</a></li>
                <li><a href="#" class="mobile-dropdown-link">Inventory Count and Assets Management</a></li>
            </ul>
        </li>

        <!-- Managed Service -->
        <li class="mobile-nav-item">
            <a href="#" class="mobile-nav-link">Managed Service <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
            <ul class="mobile-dropdown">
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Accounting Services <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Account Management/Bookkeeping</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Financial Statement Preparation</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Bank Reconciliation</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Account Payable/Receivable</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Budget and Forecasting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Forensic Accounting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Business Consulting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Public Accounting</a></li>
                    </ul>
                </li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Tax Services <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Tax Planning</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Payroll Tax</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Individual Tax - 1040</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Business Tax â€“ 1120s and 1120</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Non-for-profit Tax â€“ 990</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Tax Accounting</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">International Tax</a></li>
                    </ul>
                </li>
                <li class="mobile-sub-menu">
                    <a href="#" class="mobile-dropdown-link">Technology Services <i class="fas fa-chevron-down mobile-dropdown-icon"></i></a>
                    <ul class="mobile-sub-dropdown">
                        <li><a href="#" class="mobile-sub-dropdown-link">Asset Tracking and Management</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">IT Support Management</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Cybersecurity</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Network Support/Health Check</a></li>
                        <li><a href="#" class="mobile-sub-dropdown-link">Inventory</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</nav>
{% endif %}
        </div>
    </div>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay"></div>
</header>

<style>
/* Enhanced styles for multi-level dropdowns */
.mobile-sub-sub-menu {
    position: relative;
}

.mobile-sub-sub-dropdown {
    display: none;
    padding-left: 20px;
    margin: 5px 0;
}

.mobile-sub-sub-menu.active .mobile-sub-sub-dropdown {
    display: block;
}

.mobile-sub-sub-dropdown-link {
    display: block;
    padding: 10px 15px;
    text-decoration: none;
    color: #4a5568;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 14px;
    background-color: #f8f9fa;
    margin: 2px 0;
    border-left: 3px solid #e9ecef;
}

.mobile-sub-sub-dropdown-link:hover {
    background-color: #e9ecef;
    color: #2d3748;
}

/* Improve visual hierarchy for different levels */
.mobile-dropdown {
    padding-left: 15px;
}

.mobile-sub-dropdown {
    padding-left: 20px;
    background-color: #fafbfc;
}

.mobile-sub-dropdown-link {
    background-color: #f8f9fa;
    border-left: 2px solid #dee2e6;
}

.mobile-nav-link,
.mobile-dropdown-link,
.mobile-sub-dropdown-link {
    position: relative;
}

/* Ensure chevron icons are properly aligned */
.mobile-dropdown-icon {
    transition: transform 0.3s ease;
    font-size: 12px;
    margin-left: auto;
}

.mobile-nav-item.active .mobile-nav-link .mobile-dropdown-icon,
.mobile-sub-menu.active .mobile-dropdown-link .mobile-dropdown-icon,
.mobile-sub-sub-menu.active .mobile-sub-dropdown-link .mobile-dropdown-icon {
    transform: rotate(180deg);
}

/* Additional styles for deeper nested menus */
.mobile-sub-sub-menu {
    position: relative;
}

.mobile-sub-sub-dropdown {
    display: none;
    padding-left: 15px;
}

.mobile-sub-sub-menu.active .mobile-sub-sub-dropdown {
    display: block;
}

.mobile-sub-sub-dropdown-link {
    display: block;
    padding: 10px 15px;
    text-decoration: none;
    color: #4a5568;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 14px;
    background-color: #f8f9fa;
}

.mobile-sub-sub-dropdown-link:hover {
    background-color: #e9ecef;
}

/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    padding-top: 110px; /* Adjust for fixed header height */
}

/* Loading Animation */
@keyframes loading {
    0% { width: 0%; background: #ffd700; }
    50% { background: #f1c40f; }
    100% { width: 100%; background: #ffd700; }
}

.loading-bar {
    position: fixed;
    top: 0;
    left: 0;
    height: 3px;
    background: hsl(51, 100%, 50%);
    z-index: 1100;
    animation: loading 2s ease-in-out infinite;
}

/* Header Styles */
.header {
    background: white;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Global Bar Styles - Hidden on mobile */
.global-bar {
    background: #f8f9fa;
    padding: 5px 0;
    font-size: 13px;
    border-bottom: 1px solid #eaeaea;
    display: block;
}

.global-bar .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 30px;
    display: flex;
    justify-content: flex-end;
    align-items: center;
}

.global-links {
    display: flex;
    gap: 15px;
    align-items: center;
}

.global-link {
    color: #2c3e50;
    text-decoration: none;
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 5px 10px;
    border-radius: 4px;
    transition: background-color 0.2s;
}

.global-link:hover {
    background-color: rgba(0, 123, 255, 0.1);
    color: #007bff;
}

.admin-link {
    background-color: rgba(0, 123, 255, 0.1);
    font-weight: 500;
}

.admin-link:hover {
    background-color: rgba(0, 123, 255, 0.2);
}

.separator {
    color: #ddd;
}

/* Header Container */
.header-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    height: 80px;
}

.logo-container {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo {
    display: flex;
    align-items: center;
    text-decoration: none;
    transition: transform 0.2s ease;
}

.logo:hover {
    transform: scale(1.05);
}

.logo-image {
    height: 32px;
    width: auto;
    object-fit: contain;
}

.global-text {
    font-size: 20px;
    font-weight: 700;
    color: #2c3e50;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Enhanced Navigation Menu - EY Style */
.nav-menu {
    display: flex;
    align-items: center;
    position: relative;
    z-index: 1001;
}

.nav-list {
    list-style: none;
    display: flex;
    gap: 2px;
    margin: 0;
    padding: 0;
}

.nav-item {
    position: static; /* Changed for full-width dropdowns */
}

.nav-link {
    position: relative;
    padding: 15px 20px;
    color: #2c3e50;
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    transition: all 0.3s ease;
    border-radius: 4px 4px 0 0;
    white-space: nowrap;
}

.nav-link:hover {
    background: #f8f9fa;
    color: #007bff;
}

/* Enhanced Dropdown Structure - Full Width with Scroll */
.dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    border-radius: 0 0 8px 8px;
    z-index: 1000;
    padding: 20px;
    margin-top: 0;
    border: 1px solid #e9ecef;
    border-top: 3px solid #007bff;
    /* Scrollable container */
    max-height: 70vh;
    overflow-y: auto;
    overflow-x: hidden;
    /* Smooth scrolling */
    scroll-behavior: smooth;
    /* Custom scrollbar for webkit browsers */
    scrollbar-width: thin;
    scrollbar-color: #007bff #f1f1f1;
}

/* Custom scrollbar for webkit browsers (Chrome, Safari, Edge) */
.dropdown::-webkit-scrollbar {
    width: 8px;
}

.dropdown::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.dropdown::-webkit-scrollbar-thumb {
    background: #007bff;
    border-radius: 4px;
    transition: background 0.3s ease;
}

.dropdown::-webkit-scrollbar-thumb:hover {
    background: #0056b3;
}

.nav-item:hover .dropdown {
    display: block;
    animation: fadeInUp 0.3s ease;
}

/* Enhanced Grid Layout for Dropdown Content - All levels in same box */
.dropdown-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 40px;
    max-width: 1400px;
    margin: 0 auto;
    padding: 10px;
    /* Ensure grid doesn't overflow */
    min-height: min-content;
}

.dropdown-column {
    display: flex;
    flex-direction: column;
    /* Allow column to grow but not overflow */
    min-height: 0;
}

.dropdown-section {
    margin-bottom: 25px;
    /* Prevent section from growing too much */
    flex-shrink: 0;
}

.dropdown-section-title {
    font-weight: 700;
    color: #2c3e50;
    font-size: 16px;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 2px solid #007bff;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    /* Sticky section headers when scrolling */
    position: sticky;
    top: 0;
    background: white;
    z-index: 1;
    padding: 10px 0;
    margin-bottom: 10px;
}

/* Enhanced Link Styles - All levels visible in same container */
.dropdown-link {
    display: flex;
    align-items: center;
    padding: 10px 14px;
    color: #555;
    text-decoration: none;
    font-size: 14px;
    border-radius: 6px;
    transition: all 0.2s ease;
    margin-bottom: 6px;
    position: relative;
    word-wrap: break-word;
    white-space: normal;
    line-height: 1.4;
    hyphens: auto;
    background: #f8f9fa;
    border-left: 4px solid #007bff;
    /* Ensure links don't grow too large */
    flex-shrink: 0;
}

.dropdown-link:hover {
    background: #007bff;
    color: white;
    transform: translateX(5px);
}

/* Nested sub-menu styles - All displayed in same container */
.sub-menu {
    position: relative;
    margin: 6px 0;
}

.sub-dropdown {
    display: block !important;
    position: static !important;
    background: transparent !important;
    box-shadow: none !important;
    border: none !important;
    padding: 0 0 0 18px !important;
    margin: 6px 0 0 0 !important;
    min-width: auto !important;
    max-width: none !important;
}

.sub-dropdown-link {
    display: block;
    padding: 8px 14px;
    color: #666;
    text-decoration: none;
    font-size: 13px;
    border-radius: 4px;
    transition: all 0.2s ease;
    margin-bottom: 4px;
    word-wrap: break-word;
    white-space: normal;
    line-height: 1.4;
    background: #e9ecef;
    border-left: 3px solid #28a745;
    /* Ensure links don't grow too large */
    flex-shrink: 0;
}

.sub-dropdown-link:hover {
    background: #28a745;
    color: white;
    transform: translateX(3px);
}

/* Deeply nested sub-sub-menu styles */
.sub-sub-menu {
    position: relative;
    margin: 4px 0;
}

.sub-sub-dropdown {
    display: block !important;
    position: static !important;
    background: transparent !important;
    box-shadow: none !important;
    border: none !important;
    padding: 0 0 0 22px !important;
    margin: 4px 0 0 0 !important;
    min-width: auto !important;
    max-width: none !important;
}

.sub-sub-dropdown-link {
    display: block;
    padding: 6px 14px;
    color: #777;
    text-decoration: none;
    font-size: 12px;
    border-radius: 4px;
    transition: all 0.2s ease;
    margin-bottom: 3px;
    word-wrap: break-word;
    white-space: normal;
    line-height: 1.4;
    background: #dee2e6;
    border-left: 2px solid #ffc107;
    /* Ensure links don't grow too large */
    flex-shrink: 0;
}

.sub-sub-dropdown-link:hover {
    background: #ffc107;
    color: #212529;
    transform: translateX(2px);
}

/* Visual indicators for nested levels */
.sub-menu > .dropdown-link::before {
    content: "â†³ ";
    color: #28a745;
    font-weight: bold;
    margin-right: 5px;
}

.sub-sub-menu > .sub-dropdown-link::before {
    content: "â†³ â†³ ";
    color: #ffc107;
    font-weight: bold;
    margin-right: 5px;
}

/* Animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* Mobile Sidebar Styles */
.mobile-sidebar {
    position: fixed;
    top: 0;
    left: -100%;
    width: 85%;
    max-width: 320px;
    height: 100vh;
    background: white;
    z-index: 1100;
    transition: left 0.3s ease-in-out;
    overflow-y: auto;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
}

.mobile-sidebar.active {
    left: 0;
}

.mobile-sidebar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
    background: #f8f9fa;
}

.mobile-logo {
    display: flex;
    align-items: center;
    gap: 10px;
}

.mobile-close-btn {
    background: none;
    border: none;
    font-size: 20px;
    color: #2c3e50;
    cursor: pointer;
    padding: 5px;
}

.mobile-menu-content {
    padding: 20px;
}

.mobile-global-links {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.mobile-global-link {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 15px;
    text-decoration: none;
    color: #2c3e50;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 15px;
}

.mobile-global-link:hover {
    background-color: #f0f2f5;
}

.mobile-nav-menu {
    margin-top: 10px;
}

.mobile-nav-list {
    list-style: none;
}

.mobile-nav-item {
    margin-bottom: 5px;
}

.mobile-nav-link {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    text-decoration: none;
    color: #2c3e50;
    font-weight: 500;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 16px;
}

.mobile-nav-link:hover {
    background-color: #f0f2f5;
}

.mobile-dropdown-icon {
    transition: transform 0.3s ease;
}

.mobile-nav-item.active .mobile-dropdown-icon {
    transform: rotate(180deg);
}

.mobile-dropdown {
    display: none;
    padding-left: 15px;
    margin-top: 5px;
}

.mobile-nav-item.active .mobile-dropdown {
    display: block;
}

.mobile-dropdown-link {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    text-decoration: none;
    color: #4a5568;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 15px;
}

.mobile-dropdown-link:hover {
    background-color: #f0f2f5;
}

.mobile-sub-dropdown {
    display: none;
    padding-left: 15px;
}

.mobile-sub-menu.active .mobile-sub-dropdown {
    display: block;
}

.mobile-sub-dropdown-link {
    display: block;
    padding: 10px 15px;
    text-decoration: none;
    color: #718096;
    border-radius: 6px;
    transition: background-color 0.2s;
    font-size: 14px;
}

.mobile-sub-dropdown-link:hover {
    background-color: #f0f2f5;
}

/* Hide desktop-only elements on mobile */
@media (max-width: 768px) {
    .desktop-only {
        display: none !important;
    }

    .global-links.desktop-only {
        display: none !important;
    }
}

/* Show on larger screens */
@media (min-width: 769px) {
    .desktop-only {
        display: flex !important;
    }

    .global-links.desktop-only {
        display: flex !important;
    }
}

.mobile-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1099;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease;
}

.mobile-overlay.active {
    opacity: 1;
    visibility: visible;
}

/* Mobile Menu Styles */
.hamburger {
    display: none;
    cursor: pointer;
    padding: 10px;
    z-index: 1001;
}

.bar {
    display: block;
    width: 25px;
    height: 3px;
    margin: 5px auto;
    background-color: #2c3e50;
    transition: all 0.3s ease-in-out;
}

.hamburger.active .bar:nth-child(1) {
    transform: translateY(8px) rotate(45deg);
}

.hamburger.active .bar:nth-child(2) {
    opacity: 0;
}

.hamburger.active .bar:nth-child(3) {
    transform: translateY(-8px) rotate(-45deg);
}

/* Profile Link Styles */
.profile-link {
    display: flex;
    align-items: center;
    gap: 10px;
    text-decoration: none;
    color: inherit;
    transition: color 0.3s ease;
}

.profile-link:hover {
    color: #007bff;
}

.face-card-container {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    background-color: #f0f0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.face-card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.face-card-initials {
    font-size: 1.2rem;
    font-weight: bold;
    color: #6c757d;
}

.face-card-info {
    display: flex;
    flex-direction: column;
    font-size: 0.9rem;
}

.face-card-name {
    font-weight: bold;
    color: #333;
}

.face-card-role {
    font-size: 0.8rem;
    color: #6c757d;
}

.chatbot-link {
    color: #3498db;
    font-weight: 600;
    transition: color 0.2s ease, transform 0.2s ease;
}

.chatbot-link:hover {
    color: #2980b9;
    transform: translateY(-1px);
}

/* Responsive Design */
@media (max-width: 1200px) {
    .dropdown-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 30px;
    }
    
    .header-container {
        padding: 0 15px;
    }

    .nav-link {
        font-size: 14px;
        padding: 8px 12px;
    }

    .global-links {
        gap: 10px;
    }

    .global-link {
        font-size: 12px;
        padding: 4px 8px;
    }
}

@media (max-width: 768px) {
    body {
        padding-top: 90px;
    }

    .global-bar {
        display: none; /* Hide global bar on mobile */
    }

    .hamburger {
        display: block;
    }

    .nav-menu {
        display: none;
    }

    .global-links .global-link span {
        display: none;
    }

    .global-links .separator {
        display: none;
    }

    .global-links .profile-link .face-card-info {
        display: none;
    }

    .global-bar .container {
        padding: 0 15px;
    }

    .logo-image {
        height: 28px;
    }
}

@media (max-width: 480px) {
    .header-container {
        height: 60px;
    }

    body {
        padding-top: 70px;
    }

    .logo-image {
        height: 24px;
    }

    .global-text {
        font-size: 16px;
    }

    .global-link {
        font-size: 11px;
        padding: 3px 6px;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const hamburger = document.querySelector('.hamburger');
    const mobileSidebar = document.querySelector('.mobile-sidebar');
    const mobileOverlay = document.querySelector('.mobile-overlay');
    const mobileCloseBtn = document.querySelector('.mobile-close-btn');
    const mobileNavItems = document.querySelectorAll('.mobile-nav-item');
    const mobileSubMenus = document.querySelectorAll('.mobile-sub-menu');
    const mobileSubSubMenus = document.querySelectorAll('.mobile-sub-sub-menu');

    // Enhanced desktop navigation hover handling
    const navItems = document.querySelectorAll('.nav-item');
    
    navItems.forEach(item => {
        item.addEventListener('mouseenter', function() {
            // Close other dropdowns
            navItems.forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.classList.remove('active');
                }
            });
            this.classList.add('active');
        });
        
        item.addEventListener('mouseleave', function(e) {
            // Only remove active if mouse leaves the entire nav item area
            if (!this.contains(e.relatedTarget)) {
                this.classList.remove('active');
            }
        });
    });

    // Mobile menu toggle
    if (hamburger && mobileSidebar) {
        hamburger.addEventListener('click', function() {
            this.classList.toggle('active');
            mobileSidebar.classList.toggle('active');
            mobileOverlay.classList.toggle('active');
            document.body.style.overflow = 'hidden';
        });

        mobileCloseBtn.addEventListener('click', function() {
            closeMobileMenu();
        });

        mobileOverlay.addEventListener('click', function() {
            closeMobileMenu();
        });

        function closeMobileMenu() {
            hamburger.classList.remove('active');
            mobileSidebar.classList.remove('active');
            mobileOverlay.classList.remove('active');
            document.body.style.overflow = '';

            // Close all dropdowns when menu closes
            closeAllDropdowns();
        }

        function closeAllDropdowns() {
            mobileNavItems.forEach(item => item.classList.remove('active'));
            mobileSubMenus.forEach(menu => menu.classList.remove('active'));
            mobileSubSubMenus.forEach(menu => menu.classList.remove('active'));
        }
    }

    // Mobile dropdown toggle - Level 1 (Main categories)
    mobileNavItems.forEach(item => {
        const link = item.querySelector('.mobile-nav-link');
        if (link) {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const wasActive = item.classList.contains('active');

                // Close all dropdowns first
                closeAllDropdowns();

                // Toggle current item if it wasn't already active
                if (!wasActive) {
                    item.classList.add('active');
                }
            });
        }
    });

    // Mobile sub-menu toggle - Level 2 (Sub-categories)
    mobileSubMenus.forEach(menu => {
        const link = menu.querySelector('.mobile-dropdown-link');
        if (link) {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const wasActive = menu.classList.contains('active');

                // Close other sub-menus at the same level
                const parentDropdown = menu.closest('.mobile-dropdown, .mobile-sub-dropdown');
                if (parentDropdown) {
                    const siblings = parentDropdown.querySelectorAll('.mobile-sub-menu');
                    siblings.forEach(sibling => {
                        if (sibling !== menu) {
                            sibling.classList.remove('active');
                        }
                    });
                }

                // Toggle current menu
                if (!wasActive) {
                    menu.classList.add('active');
                } else {
                    menu.classList.remove('active');
                }
            });
        }
    });

    // Mobile sub-sub-menu toggle - Level 3 (Deepest nesting)
    mobileSubSubMenus.forEach(menu => {
        const link = menu.querySelector('.mobile-sub-dropdown-link');
        if (link) {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const wasActive = menu.classList.contains('active');

                // Close other sub-sub-menus at the same level
                const parentDropdown = menu.closest('.mobile-sub-dropdown, .mobile-sub-sub-dropdown');
                if (parentDropdown) {
                    const siblings = parentDropdown.querySelectorAll('.mobile-sub-sub-menu');
                    siblings.forEach(sibling => {
                        if (sibling !== menu) {
                            sibling.classList.remove('active');
                        }
                    });
                }

                // Toggle current menu
                if (!wasActive) {
                    menu.classList.add('active');
                } else {
                    menu.classList.remove('active');
                }
            });
        }
    });

    // Close mobile menu when clicking on a final link (not a dropdown toggle)
    const mobileLinks = document.querySelectorAll(
        '.mobile-global-link, ' +
        '.mobile-nav-link, ' +
        '.mobile-dropdown-link, ' +
        '.mobile-sub-dropdown-link, ' +
        '.mobile-sub-sub-dropdown-link'
    );

    mobileLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            // Check if this link has a dropdown icon (is a toggle)
            const hasDropdownIcon = this.querySelector('.mobile-dropdown-icon');

            // If it's not a dropdown toggle link, close the menu
            if (!hasDropdownIcon) {
                // Small delay to allow the click to register before closing
                setTimeout(() => {
                    closeMobileMenu();
                }, 100);
            }
        });
    });

    // Handle clicks outside the sidebar to close it
    document.addEventListener('click', function(e) {
        if (mobileSidebar.classList.contains('active') &&
            !e.target.closest('.mobile-sidebar') &&
            !e.target.closest('.hamburger')) {
            closeMobileMenu();
        }
    });

    // Handle escape key to close menu
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && mobileSidebar.classList.contains('active')) {
            closeMobileMenu();
        }
    });

    // Improved loading animation
    window.addEventListener('load', function() {
        const loadingBar = document.querySelector('.loading-bar');
        if (loadingBar) {
            // Smoothly complete the animation
            loadingBar.style.transition = 'width 0.5s ease, opacity 0.3s ease';
            loadingBar.style.width = '100%';

            setTimeout(() => {
                loadingBar.style.opacity = '0';
                setTimeout(() => {
                    if (loadingBar.parentNode) {
                        loadingBar.parentNode.removeChild(loadingBar);
                    }
                }, 300);
            }, 500);
        }
    });

    // Handle window resize - close menu if switching to desktop size
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768 && mobileSidebar.classList.contains('active')) {
            closeMobileMenu();
        }
    });
});
</script>